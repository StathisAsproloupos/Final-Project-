Ευστράτιος Προφύρης :Π20164
Στάθης Ασπρολούπος : Π20026

1)
Η κλάση Table έχει δύο μεθόδους. Η μέθοδος select_rows παίρνει ένα όρισμα Where_clause και επιστρέφει μια λίστα με σειρές από τον πίνακα που ικανοποιούν τον όρο. Το όρισμα Where_clause είναι μια πλειάδα που καθορίζει μια συνθήκη για την επιλογή γραμμών από τον πίνακα. Η μέθοδος _where_clause_eval είναι μια βοηθητική μέθοδος που αξιολογεί την ρήτρα where_για μια μεμονωμένη σειρά.

Το όρισμα Where_clause είναι είτε None είτε πλειάδα μήκους 3. Εάν είναι None, τότε επιλέγονται όλες οι σειρές στον πίνακα. Εάν πρόκειται για πλειάδα, τότε το πρώτο στοιχείο καθορίζει το όνομα της στήλης, το δεύτερο στοιχείο καθορίζει τον τελεστή που θα χρησιμοποιηθεί για σύγκριση και το τρίτο στοιχείο καθορίζει την τιμή που πρέπει να συγκρίνει.

Η μέθοδος _where_clause_eval αξιολογεί την ρήτρα where_clause για μια μεμονωμένη γραμμή ελέγχοντας πρώτα εάν η ρήτρα_που είναι Καμία. Εάν είναι, τότε επιλέγεται η σειρά. Εάν το where_clause είναι πλειάδα, τότε το όνομα της στήλης χρησιμοποιείται για την ανάκτηση της τιμής της στήλης για την τρέχουσα σειρά. Στη συνέχεια, η τιμή συγκρίνεται με την καθορισμένη τιμή χρησιμοποιώντας τον καθορισμένο τελεστή.

Η κλάση MiniDB έχει μια ενιαία μέθοδο, execute_select, η οποία παίρνει ένα όρισμα table_name και ένα προαιρετικό όρισμα where_clause. Ανακτά το αντικείμενο του πίνακα από το λεξικό πινάκων και καλεί τη μέθοδο select_rows με το where_clause. Στη συνέχεια, επιστρέφει τις επιλεγμένες σειρές.


2)
Η κλάση MiniDB έχει τρεις κύριες μεθόδους:

create_table: δημιουργεί έναν νέο πίνακα με ένα δεδομένο όνομα και μια λίστα στηλών. Οι στήλες ορίζονται χρησιμοποιώντας την κλάση Column και μπορούν να έχουν όνομα, τύπο δεδομένων και διάφορα χαρακτηριστικά, όπως εάν είναι μοναδικά ή μέρος του πρωτεύοντος κλειδιού του πίνακα. Εάν μια στήλη είναι μοναδική, δημιουργείται ένα ευρετήριο σε αυτήν τη στήλη για τη βελτιστοποίηση των ερωτημάτων που φιλτράρουν σε αυτήν τη στήλη.
create_index: δημιουργεί ένα ευρετήριο πάνω από μια στήλη σε έναν πίνακα. Το ευρετήριο μπορεί να είναι τύπου BTree ή Hash, ανάλογα με τον τύπο της στήλης.
get_table: επιστρέφει ένα αντικείμενο πίνακα για ένα δεδομένο όνομα πίνακα.
Η κλάση MiniDB χρησιμοποιεί πολλές άλλες κλάσεις για την υλοποίηση της λειτουργικότητάς της. Η κλάση Column ορίζει μια στήλη και τα χαρακτηριστικά της, η κλάση Index είναι μια βασική κλάση για ευρετήρια BTree και Hash και η κλάση Table ορίζει έναν πίνακα και τις στήλες, το πρωτεύον κλειδί και τα ευρετήρια του. Η κλάση MetaTable αποθηκεύει μεταδεδομένα σχετικά με έναν πίνακα, όπως το πρωτεύον κλειδί και τα ευρετήρια του.

Οι κλάσεις BTree και Node υλοποιούν μια απλή δομή δεδομένων B-Tree που χρησιμοποιείται για την ευρετηρίαση μοναδικών στηλών. Η κλάση BTreeIndex δημιουργεί ένα ευρετήριο σε μια μοναδική στήλη χρησιμοποιώντας μια δομή δεδομένων B-Tree και η κλάση HashIndex δημιουργεί ένα ευρετήριο σε μια μη μοναδική στήλη χρησιμοποιώντας έναν πίνακα κατακερματισμού.




3)
Δημιουργεί και αξιολογεί σχέδια ερωτημάτων για ένα δεδομένο σύνολο συνθηκών SELECT, στηλών έργου και συνθηκών ένωσης. Ο προγραμματιστής ερωτημάτων χρησιμοποιεί ένα απλό μοντέλο κόστους για να εκτιμήσει το κόστος κάθε σχεδίου ερωτήματος και επιλέγει το πρόγραμμα με το χαμηλότερο κόστος.

Ο κώδικας ορίζει έναν τύπο πίνακα, ο οποίος είναι μια λίστα λεξικών. Κάθε λεξικό αντιπροσωπεύει μια σειρά στον πίνακα, με τα ονόματα στηλών ως κλειδιά και τις τιμές στηλών ως τιμές. Ο κώδικας ορίζει επίσης διάφορες συναρτήσεις για την υλοποίηση πράξεων ερωτήματος:

project: προβάλλει ένα υποσύνολο στηλών από έναν πίνακα και επιστρέφει έναν νέο πίνακα.
Select: επιλέγει σειρές από έναν πίνακα που ικανοποιούν μια δεδομένη συνθήκη και επιστρέφει έναν νέο πίνακα.
join: ενώνει δύο πίνακες με βάση μια δεδομένη συνθήκη ένωσης και επιστρέφει έναν νέο πίνακα.
get_column_stats: υπολογίζει στατιστικά στοιχεία στήλης για μια δεδομένη στήλη σε έναν πίνακα, συμπεριλαμβανομένου του αριθμού των διακριτών τιμών, της ελάχιστης τιμής, της μέγιστης τιμής και ενός ιστογράμματος των τιμών.
estimate_query_cost: εκτιμά το κόστος ενός σχεδίου ερωτήματος με βάση τους τελεστές και τα στατιστικά στοιχεία στηλών.
generate_query_plans: δημιουργεί ένα σύνολο σχεδίων ερωτημάτων για ένα δεδομένο σύνολο συνθηκών SELECT, στηλών έργου και συνθηκών ένωσης και επιλέγει το σχέδιο με το χαμηλότερο εκτιμώμενο κόστος. Η συνάρτηση επιστρέφει μια λίστα λεξικών, όπου κάθε λεξικό αντιπροσωπεύει έναν τελεστή στο σχέδιο ερωτήματος και τις παραμέτρους του. Οι πιθανοί τύποι χειριστή είναι SELECT, PROJECT και JOIN. Κάθε χειριστής έχει ένα σύνολο στατιστικών στηλών που χρησιμοποιούνται για την εκτίμηση του κόστους του.
